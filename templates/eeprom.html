<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cell Board - Genetic Circuit Designer</title>
    <link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/styles.css') }}" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="{{ url_for('dial') }}">
                <i class="fas fa-dna me-2"></i>Genetic Circuit Designer
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="{{ url_for('dial') }}">Virtual Mode</a>
                <a class="nav-link active" href="{{ url_for('eeprom') }}">Board Mode</a>
                <a class="nav-link" href="{{ url_for('about') }}">About</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Header -->
        <header class="text-center mb-4">
            <h1><i class="fas fa-microchip me-2"></i>Cell Board Control</h1>
            <p class="lead">Interface with physical genetic circuit board</p>
        </header>

        <!-- Cell Board Control Panel -->
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-usb me-2"></i>Connection</h3>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="com-port" class="form-label">COM Port:</label>
                            <select id="com-port" class="form-select">
                                <option value="">Select COM Port</option>
                            </select>
                        </div>
                        
                        <div class="d-flex gap-2">
                            <button id="btn-refresh-ports" class="btn btn-secondary">
                                <i class="fas fa-sync-alt me-2"></i>Refresh Ports
                            </button>
                            <button id="btn-connect" class="btn btn-primary">
                                <i class="fas fa-plug me-2"></i>Connect
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card mt-3">
                    <div class="card-header">
                        <h3><i class="fas fa-download me-2"></i>Board Reading</h3>
                    </div>
                    <div class="card-body">
                        <p class="text-muted">Read the current genetic circuit configuration from the physical board.</p>
                        
                        <div class="d-flex gap-2">
                            <button id="btn-get-board" class="btn btn-success">
                                <i class="fas fa-download me-2"></i>Read Circuit from Board
                            </button>
                            
                            <button id="btn-diagnose-board" class="btn btn-info">
                                <i class="fas fa-search me-2"></i>Diagnose Cell Board
                            </button>
                        </div>
                        
                        <div class="mt-3">
                            <button id="btn-transfer-designer" class="btn btn-primary" style="display: none;">
                                <i class="fas fa-external-link-alt me-2"></i>Transfer to Main Designer
                            </button>
                        </div>
                        
                        <div class="mt-3">
                            <small class="text-muted">
                                This will scan all MUX channels and populate the design board with detected components.
                            </small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <!-- Design Board Preview -->
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-th-large me-2"></i>Board Preview</h3>
                    </div>
                    <div class="card-body">
                        <div class="grid-container mx-auto"  style="width: max-content; padding: 10px; border: 3px solid var(--primary); border-radius: var(--border-radius);">
                            <img src="static/css/attached_assests/weas.png" alt="Lab_Logo-C11" class="lab-logoss">
                        <div class="cell-board-header1">
                        <h1 class="cell-board-title1">
                        <span class="letter-c">C</span>
                        <span class="letter-e1">e</span>
                        <span class="letter-l2">l</span>
                        <span class="letter-l3">l</span>
                        <span class="letter-space"> </span>
                        <span class="letter-b">B</span>
                        <span class="letter-o">o</span>
                        <span class="letter-a">a</span>
                        <span class="letter-r">r</span>
                        <span class="letter-d">d</span>
                        </h1>
                        <p class="lab-subtitle1">By the Lopatkin Lab</p>
                </div>
                            <!-- 8x8 Grid -->
                             <div class="grid-row1">
                            <div class="cell functional" data-x="0" data-y="0"></div>
                            <div class="cell functional" data-x="1" data-y="0"></div>
                            <div class="cell functional" data-x="2" data-y="0"></div>
                            <div class="cell functional" data-x="3" data-y="0"></div>
                            <div class="cell functional" data-x="4" data-y="0"></div>
                            <div class="cell functional" data-x="5" data-y="0"></div>
                            <div class="cell functional" data-x="6" data-y="0"></div>
                            <div class="cell functional" data-x="7" data-y="0"></div>
                            <div class="cell functional" data-x="8" data-y="0"></div>
                            <div class="cell functional" data-x="9" data-y="0"></div>
                        </div>
                        <div class="grid-row1">
                            <div class="cell functional" data-x="0" data-y="1"></div>
                            <div class="cell functional" data-x="1" data-y="1"></div>
                            <div class="cell functional" data-x="2" data-y="1"></div>
                            <div class="cell functional" data-x="3" data-y="1"></div>
                            <div class="cell functional" data-x="4" data-y="1"></div>
                            <div class="cell functional" data-x="5" data-y="1"></div>
                            <div class="cell functional" data-x="6" data-y="1"></div>
                            <div class="cell functional" data-x="7" data-y="1"></div>
                            <div class="cell functional" data-x="8" data-y="1"></div>
                            <div class="cell functional" data-x="9" data-y="1"></div>
                        </div>
                        <div class="grid-row1">
                            <div class="cell functional" data-x="0" data-y="2"></div>
                            <div class="cell functional" data-x="1" data-y="2"></div>
                            <div class="cell functional" data-x="2" data-y="2"></div>
                            <div class="cell functional" data-x="3" data-y="2"></div>
                            <div class="cell functional" data-x="4" data-y="2"></div>
                            <div class="cell functional" data-x="5" data-y="2"></div>
                            <div class="cell functional" data-x="6" data-y="2"></div>
                            <div class="cell functional" data-x="7" data-y="2"></div>
                            <div class="cell functional" data-x="8" data-y="2"></div>
                            <div class="cell functional" data-x="9" data-y="2"></div>
                        </div>
                        <div class="grid-row1">
                            <div class="cell functional" data-x="0" data-y="3"></div>
                            <div class="cell functional" data-x="1" data-y="3"></div>
                            <div class="cell functional" data-x="2" data-y="3"></div>
                            <div class="cell functional" data-x="3" data-y="3"></div>
                            <div class="cell functional" data-x="4" data-y="3"></div>
                            <div class="cell functional" data-x="5" data-y="3"></div>
                            <div class="cell functional" data-x="6" data-y="3"></div>
                            <div class="cell functional" data-x="7" data-y="3"></div>
                            <div class="cell functional" data-x="8" data-y="3"></div>
                            <div class="cell functional" data-x="9" data-y="3"></div>
                        </div>
                        <div class="grid-row1">
                            <div class="cell functional" data-x="0" data-y="4"></div>
                            <div class="cell functional" data-x="1" data-y="4"></div>
                            <div class="cell functional" data-x="2" data-y="4"></div>
                            <div class="cell functional" data-x="3" data-y="4"></div>
                            <div class="cell functional" data-x="4" data-y="4"></div>
                            <div class="cell functional" data-x="5" data-y="4"></div>
                            <div class="cell functional" data-x="6" data-y="4"></div>
                            <div class="cell functional" data-x="7" data-y="4"></div>
                            <div class="cell functional" data-x="8" data-y="4"></div>
                            <div class="cell functional" data-x="9" data-y="4"></div>
                        </div>
                        <div class="grid-row1">
                            <div class="cell functional" data-x="0" data-y="5"></div>
                            <div class="cell functional" data-x="1" data-y="5"></div>
                            <div class="cell functional" data-x="2" data-y="5"></div>
                            <div class="cell functional" data-x="3" data-y="5"></div>
                            <div class="cell functional" data-x="4" data-y="5"></div>
                            <div class="cell functional" data-x="5" data-y="5"></div>
                            <div class="cell functional" data-x="6" data-y="5"></div>
                            <div class="cell functional" data-x="7" data-y="5"></div>
                            <div class="cell functional" data-x="8" data-y="5"></div>
                            <div class="cell functional" data-x="9" data-y="5"></div>
                        </div>
                        <div class="grid-row1">
                            <div class="cell functional" data-x="0" data-y="6"></div>
                            <div class="cell functional" data-x="1" data-y="6"></div>
                            <div class="cell functional" data-x="2" data-y="6"></div>
                            <div class="cell functional" data-x="3" data-y="6"></div>
                            <div class="cell functional" data-x="4" data-y="6"></div>
                            <div class="cell functional" data-x="5" data-y="6"></div>
                            <div class="cell functional" data-x="6" data-y="6"></div>
                            <div class="cell functional" data-x="7" data-y="6"></div>
                            <div class="cell functional" data-x="8" data-y="6"></div>
                            <div class="cell functional" data-x="9" data-y="6"></div>
                        </div>
                        <div class="grid-row1">
                            <div class="cell functional" data-x="0" data-y="7"></div>
                            <div class="cell functional" data-x="1" data-y="7"></div>
                            <div class="cell functional" data-x="2" data-y="7"></div>
                            <div class="cell functional" data-x="3" data-y="7"></div>
                            <div class="cell functional" data-x="4" data-y="7"></div>
                            <div class="cell functional" data-x="5" data-y="7"></div>
                            <div class="cell functional" data-x="6" data-y="7"></div>
                            <div class="cell functional" data-x="7" data-y="7"></div>
                            <div class="cell functional" data-x="8" data-y="7"></div>
                            <div class="cell functional" data-x="9" data-y="7"></div>
                        </div>
                         <div class="grid-row1">
                            <div class="cell functional" data-x="0" data-y="8"></div>
                            <div class="cell functional" data-x="1" data-y="8"></div>
                            <div class="cell functional" data-x="2" data-y="8"></div>
                            <div class="cell functional" data-x="3" data-y="8"></div>
                            <div class="cell functional" data-x="4" data-y="8"></div>
                            <div class="cell functional" data-x="5" data-y="8"></div>
                            <div class="cell functional" data-x="6" data-y="8"></div>
                            <div class="cell functional" data-x="7" data-y="8"></div>
                            <div class="cell functional" data-x="8" data-y="8"></div>
                            <div class="cell functional" data-x="9" data-y="8"></div>
                        </div>
                         <div class="grid-row1">
                            <div class="cell functional" data-x="0" data-y="9"></div>
                            <div class="cell functional" data-x="1" data-y="9"></div>
                            <div class="cell functional" data-x="2" data-y="9"></div>
                            <div class="cell functional" data-x="3" data-y="9"></div>
                            <div class="cell functional" data-x="4" data-y="9"></div>
                            <div class="cell functional" data-x="5" data-y="9"></div>
                            <div class="cell functional" data-x="6" data-y="9"></div>
                            <div class="cell functional" data-x="7" data-y="9"></div>
                            <div class="cell functional" data-x="8" data-y="9"></div>
                            <div class="cell functional" data-x="9" data-y="9"></div>
                        </div>
                    </div>
                        
                        <div class="mt-3 text-center">
                            <button class="btn btn-outline-primary" onclick="window.location.href='{{ url_for('dial') }}'">
                                <i class="fas fa-arrow-right me-2"></i>Go to Designer
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cell Board Log -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-terminal me-2"></i>Cell Board Communication Log</h3>
                    </div>
                    <div class="card-body">
                        <textarea id="eeprom-log" class="form-control" style="height: 300px; font-family: monospace;" readonly 
                                  placeholder="Cell Board communication logs will appear here..."></textarea>
                        
                        <div class="mt-3">
                            <button class="btn btn-secondary btn-sm" onclick="clearLogAndBoard()">
                                <i class="fas fa-trash me-2"></i>Clear Log
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Display -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="results">
                    <h2><i class="fas fa-chart-line me-2"></i>Hardware Circuit Analysis</h2>
                    <div class="error-message" id="error-display"></div>
                    <div class="plot-area" id="plot-container">
                        <div class="loading">
                            <i class="fas fa-microchip" style="color: var(--primary); font-size: 2rem;"></i>
                            <p>Connect to hardware and read circuit configuration</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/eeprom.js') }}"></script>
</body>
</html>
